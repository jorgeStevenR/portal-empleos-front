<div class="perfil-container" *ngIf="!loading; else loadingTpl">
  <h2 class="perfil-title">
    {{ isCompany ? 'Perfil de Empresa' : 'Perfil de Usuario' }}
  </h2>

  <!--  Bloque de imagen o CV -->
  <div class="perfil-file-section">
    <div *ngIf="isCompany; else candidatoTpl">
      <h3>Logo de la Empresa</h3>
      <div class="logo-preview">
        <img
          *ngIf="userData.logoUrl; else noLogo"
          [src]="userData.logoUrl"
          alt="Logo de la empresa"
        />
        <ng-template #noLogo>
          <p class="no-file">Sin logo cargado</p>
        </ng-template>
      </div>
    </div>

    <ng-template #candidatoTpl>
      <h3>Curr铆culum (PDF)</h3>
      <div class="cv-preview">
        <a
          *ngIf="userData.cvUrl; else noCv"
          [href]="userData.cvUrl"
          target="_blank"
          class="cv-link"
        >
           Ver CV cargado
        </a>
        <ng-template #noCv>
          <p class="no-file">Sin CV cargado</p>
        </ng-template>
      </div>
    </ng-template>

    <div class="upload-actions">
      <input
        type="file"
        (change)="onFileSelected($event)"
        [accept]="isCompany ? 'image/*' : '.pdf'"
        id="fileInput"
      />
      <button (click)="uploadFile()" [disabled]="loading">Subir archivo</button>
    </div>
  </div>

  <hr />

  <!--  Formulario de edici贸n general -->
  <form class="perfil-form" (ngSubmit)="saveChanges()">
    <div class="form-group">
      <label>Nombre:</label>
      <input
        type="text"
        [(ngModel)]="userData.name"
        name="name"
        required
        [readonly]="isCompany"
      />
    </div>

    <div *ngIf="isCompany" class="form-group">
      <label>NIT:</label>
      <input type="text" [(ngModel)]="userData.nit" name="nit" required />
    </div>

    <div class="form-group">
      <label>Correo electr贸nico:</label>
      <input
        type="email"
        [(ngModel)]="userData.emailEntity?.email || userData.email"
        name="email"
        readonly
      />
    </div>

    <div class="form-group">
      <label>Ubicaci贸n:</label>
      <input type="text" [(ngModel)]="userData.location" name="location" />
    </div>

    <div class="form-group">
      <label>Descripci贸n:</label>
      <textarea
        [(ngModel)]="userData.description"
        name="description"
        rows="3"
      ></textarea>
    </div>

    <button type="submit" [disabled]="loading">Guardar cambios</button>
  </form>
</div>

<!--  Estado de carga -->
<ng-template #loadingTpl>
  <div class="loading">
    <p>Cargando perfil...</p>
  </div>
</ng-template>
